<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Toxic code snippets on Stack Overflow</title>
    <meta name="description" content="Toxic code snippets on Stack Overflow -- the website accompanying the TSE submission of the project.
">


    <link rel="stylesheet" href="/cloverflow-web/css/main.css">
    <link rel="stylesheet" href="/cloverflow-web/css/custom.css">
    <link rel="stylesheet" href="/cloverflow-web/css/font-awesome.min.css">

    <link rel="shortcut icon" href="/cloverflow-web/favicon.ico?1">
    <!-- Begin Jekyll SEO tag v2.2.2 -->
<title>Toxic code snippets on Stack Overflow | Toxic code snippets on Stack Overflow – the website accompanying the TSE submission of the project.</title>
<meta property="og:title" content="Toxic code snippets on Stack Overflow" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Toxic code snippets on Stack Overflow – the website accompanying the TSE submission of the project." />
<meta property="og:description" content="Toxic code snippets on Stack Overflow – the website accompanying the TSE submission of the project." />
<link rel="canonical" href="http://localhost:4000/cloverflow-web/" />
<meta property="og:url" content="http://localhost:4000/cloverflow-web/" />
<meta property="og:site_name" content="Toxic code snippets on Stack Overflow" />
<script type="application/ld+json">
{"@context":"http://schema.org","@type":"WebSite","name":"Toxic code snippets on Stack Overflow","headline":"Toxic code snippets on Stack Overflow","description":"Toxic code snippets on Stack Overflow – the website accompanying the TSE submission of the project.","url":"http://localhost:4000/cloverflow-web/"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="canonical" href="http://localhost:4000/cloverflow-web/">
    <link rel="alternate" type="application/rss+xml" title="Toxic code snippets on Stack Overflow" href="http://localhost:4000/cloverflow-web/feed.xml" />
</head>


<body>

    <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container navbar-container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
            <a class="navbar-brand" href="/cloverflow-web/">
                <span><img src="/cloverflow-web/img/logonav.png"></span> Toxic code snippets on Stack Overflow
            </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li ><a href="/cloverflow-web/docs/home/">Methodology &amp; Findings</a></li>
                <li><a href="/cloverflow-web/author.html">Authors</a></li>
                <li><a href="/cloverflow-web/downloads.html">Downloads</a></li>
                <li ><a href="/cloverflow-web/blog/2017/05/03/jekyll-doc-theme/">News</a></li>
            </ul>
            <div class="navbar-right">
                <!-- <form class="navbar-form navbar-left">
                    <div class="form-group has-feedback">
                        <input id="search-box" type="text" class="form-control" placeholder="Search...">
                        <i class="fa fa-search form-control-feedback"></i>
                    </div>
                </form> -->
                <ul class="nav navbar-nav">
                    <li><a href="https://github.com/aksakalli/jekyll-doc-theme"><i class="fa fa-github" aria-hidden="true"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>


    <div class="page-content">
        <div class="wrapper">
            <div class="header-container jumbotron">
    <div class="container">
        <h1>Toxic code snippets on Stack Overflow</h1>
        <h3>Ragkhitwetsagul C., Krinke J., Paixao M., Bianco G., Oliveto R.</h3>
        <p>Our empirical study of online code clones between 72,365 Java code snippets
          on Stack Overflow <i class="fa fa-stack-overflow" aria-hidden="true"></i> and 111 Java open source projects reveals toxic code snippets:
          101 outdated and 214 potentially license-violating clone pairs.</p>
        <p><a class="btn btn-primary btn-lg" href="/cloverflow-web/docs/home/" role="button">See methodology and findings</a></p>
    </div>
</div>


<div class="container">

    <div class="row">
        <div class="col-md-6">
            <h2 class="header-light regular-pad">Online Code Clones</h2>
            <blockquote>
              <p>
                We call code snippets that are copied from software systems to online Q&amp;A
                websites (such as Stack Overflow) and vice versa as <b>online code clones</b>.
                There are two directions in creating online code clones: (1) code is cloned from
                a software project to a Q&amp;A website as an example; or (2) code is cloned from a
                Q&amp;A website to a software project to obtain a functionality, perform a
                particular task, or fixing a bug.
              </p>
            </blockquote>
        </div>

        <div class="col-md-6 text-center">
            <img src="img/online_clones.jpeg" alt="" class="img-responsive">
        </div>
    </div>

    <hr>

    <div class="row">
        <div class="col-md-12">
            <h2 class="header-light regular-pad">Toxic Code Snippets</h2>
            <blockquote>
              <p>Toxic code snippets mean code snippets that are harmful for reuse and, in
                  several cases, are caused by online code cloning.
                  We found that Stack Overflow code snippets originated from open source software or online sources can become toxic when they
                  are (1) outdated or (2) violating their original software
                  license.</p>
            </blockquote>
        </div>
    </div>

    <div class="row">
        <div class="col-sm-6">
            <h1 class="text-center"><i class="fa fa-calendar-times-o" aria-hidden="true"></i></h1>
            <h3 class="text-center">Outdated code</h3>
            <p>
              Outdated code occurs when a piece of code
              has been copied from its origin to another location and later the original has
              been updated (Xia et al., 2014). Usually code clone detection is used to locate
              clone instances and update them to match with the originals.
              However, online code clones are more difficult to detect than in regular
              software projects due to its large search space and a mix of natural and
              programming languages combined in the same post.
            </p>
        </div>
        <div class="col-sm-6">
            <h1 class="text-center"><i class="fa fa-balance-scale" aria-hidden="true"></i></h1>
            <h3 class="text-center">Licensing violation</h3>
            <p>This template uses <a href="https://github.com/twbs/bootstrap-sass">bootstrap-sass</a> along with <a href="https://bootswatch.com/">Bootwatch themes</a>.
            You can change the theme or write your custom by overwriting bootstrap sass variables for different color set, font options, etc.</p>
        </div>
    </div>

    <hr>

    <div class="row">
      <h2 class="header-light regular-pad">Examples of Toxic Code Snippets</h2>
      <h3>1. The Hadoop's <code class="highlighter-rouge">compare</code> method</h3>
      <p>
        The first example is outdated and license-violating online code clones in an
        answer to a <a href="https://stackoverflow.com/questions/22262310/hadoop-map-output-key-doesnt-implement-writablecomparable-implementing-rawcom/22315734#22315734">Stack Overflow question</a> regarding how to implement
        <code class="highlighter-rouge">RawComparator</code> in <a href="http://hadoop.apache.org/">Hadoop</a>.
        The figure below shows, on the left, a code snippet embedded as a part
        of the accepted answer. The snippet shows how <a href="http://hadoop.apache.org/">Hadoop</a> implements the
        <code class="highlighter-rouge">compare</code> method in its <code class="highlighter-rouge">WritableComparator</code>
        class. The code snippet on the right shows another version of the same method,
        but at this time extracted from the latest version (as of October 3, 2017) of
        <a href="http://hadoop.apache.org/">Hadoop</a>. We can see that they both are highly similar except a line
        containing <code class="highlighter-rouge">buffer.reset(null,0,0);</code> which was added on November
        21, 2014. The added line is intended for cleaning up the reference in the
        <code class="highlighter-rouge">buffer</code> variable and avoid excess heap usage
        (issue no. <a href="https://issues.apache.org/jira/browse/HADOOP-11323">HADOOP-11323</a>).
      </p>
      <div class="col-md-6 text-left">
          <!-- HTML generated using hilite.me -->
          <div class="code"><pre style="line-height: 125%"><span style="color: #888888">/* Code in Stack Overflow post ID 22315734 (no license) */</span>
<span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">int</span> <span style="color: #0066BB; font-weight: bold">compare</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> b1<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">int</span> s1<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">int</span> l1<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> b2<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">int</span> s2<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">int</span> l2<span style="color: #333333">)</span> <span style="color: #333333">{</span>
  <span style="color: #008800; font-weight: bold">try</span> <span style="color: #333333">{</span>
    buffer<span style="color: #333333">.</span><span style="color: #0000CC">reset</span><span style="color: #333333">(</span>b1<span style="color: #333333">,</span> s1<span style="color: #333333">,</span> l1<span style="color: #333333">);</span> <span style="color: #888888">// parse key1</span>
    key1<span style="color: #333333">.</span><span style="color: #0000CC">readFields</span><span style="color: #333333">(</span>buffer<span style="color: #333333">);</span>
    buffer<span style="color: #333333">.</span><span style="color: #0000CC">reset</span><span style="color: #333333">(</span>b2<span style="color: #333333">,</span> s2<span style="color: #333333">,</span> l2<span style="color: #333333">);</span> <span style="color: #888888">// parse key2</span>
    key2<span style="color: #333333">.</span><span style="color: #0000CC">readFields</span><span style="color: #333333">(</span>buffer<span style="color: #333333">);</span>
  <span style="color: #333333">}</span> <span style="color: #008800; font-weight: bold">catch</span> <span style="color: #333333">(</span>IOException e<span style="color: #333333">)</span> <span style="color: #333333">{</span>
    <span style="color: #008800; font-weight: bold">throw</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">RuntimeException</span><span style="color: #333333">(</span>e<span style="color: #333333">);</span>
  <span style="color: #333333">}</span>
  <span style="color: #008800; font-weight: bold">return</span> <span style="color: #0066BB; font-weight: bold">compare</span><span style="color: #333333">(</span>key1<span style="color: #333333">,</span> key2<span style="color: #333333">);</span> <span style="color: #888888">// compare them</span>
<span style="color: #333333">}</span>
        </pre></div>
      </div>
      <div class="col-md-6 text-left">
        <!-- HTML generated using hilite.me -->
        <div class="code">
          <pre style="line-height: 125%">
<span style="color: #888888">/* WritableComparator.java (2014-11-21) (Apache v.2.0 license) */</span>
<span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">int</span> <span style="color: #0066BB; font-weight: bold">compare</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> b1<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">int</span> s1<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">int</span> l1<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">byte</span><span style="color: #333333">[]</span> b2<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">int</span> s2<span style="color: #333333">,</span><span style="color: #333399; font-weight: bold">int</span> l2<span style="color: #333333">)</span> <span style="color: #333333">{</span>
  <span style="color: #008800; font-weight: bold">try</span> <span style="color: #333333">{</span>
    buffer<span style="color: #333333">.</span><span style="color: #0000CC">reset</span><span style="color: #333333">(</span>b1<span style="color: #333333">,</span> s1<span style="color: #333333">,</span> l1<span style="color: #333333">);</span>  <span style="color: #888888">// parse key1</span>
    key1<span style="color: #333333">.</span><span style="color: #0000CC">readFields</span><span style="color: #333333">(</span>buffer<span style="color: #333333">);</span>
    buffer<span style="color: #333333">.</span><span style="color: #0000CC">reset</span><span style="color: #333333">(</span>b2<span style="color: #333333">,</span> s2<span style="color: #333333">,</span> l2<span style="color: #333333">);</span>  <span style="color: #888888">// parse key2</span>
    key2<span style="color: #333333">.</span><span style="color: #0000CC">readFields</span><span style="color: #333333">(</span>buffer<span style="color: #333333">);</span>
    buffer<span style="color: #333333">.</span><span style="color: #0000CC">reset</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">null</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">);</span>  <span style="color: #888888">// clean up reference</span>
  <span style="color: #333333">}</span> <span style="color: #008800; font-weight: bold">catch</span> <span style="color: #333333">(</span>IOException e<span style="color: #333333">)</span> <span style="color: #333333">{</span>
    <span style="color: #008800; font-weight: bold">throw</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">RuntimeException</span><span style="color: #333333">(</span>e<span style="color: #333333">);</span>
  <span style="color: #333333">}</span>
  <span style="color: #008800; font-weight: bold">return</span> <span style="color: #0066BB; font-weight: bold">compare</span><span style="color: #333333">(</span>key1<span style="color: #333333">,</span> key2<span style="color: #333333">);</span>  <span style="color: #888888">// compare them</span>
<span style="color: #333333">}</span>
        </pre></div>
      </div>

      <p>
        While this change has already been introduced into the
        <code class="highlighter-rouge">compare</code> method several years ago, the code example in Stack
        Overflow post is still unchanged.
        In addition, the original code snippet of
        <code class="highlighter-rouge">WritableComparator</code> class in Hadoop is distributed with <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache license
        version 2.0</a> while its cloned instance on Stack Overflow contains only the
        <code class="highlighter-rouge">compare</code> method and ignores its license statement on top of the
        file. There are two potential issues for this. First, the code snippet may appear to be
        under Stack Overflow's <a hrer="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0</a> instead of its original Apache
        license. Second, if the code snippet is copied and incorporated into another
        software project with a conflicting license, a legal issue may arise.
      </p>

      <h3>2. The Hadoop's <code class="highlighter-rouge">humanReadableInt</code> method</h3>
      <p>
        The second motivating example of a toxic code snippet with more
        disrupting changes than the first one can be found in an answer to a <a href="https://stackoverflow.com/questions/801987">Stack
        Overflow question</a> regarding how to format files sizes in a human readable form.
        The figure below shows, on the left, a code snippet to perform the
        task from the <code class="highlighter-rouge">StringUtils</code> class in <a href="http://hadoop.apache.org/">Hadoop</a>. The code snippet on the
        right shows another version of the same method, but at this time extracted from
        the latest version of <a href="http://hadoop.apache.org/">Hadoop</a>. We can see that
        they are totally different. The <code class="highlighter-rouge">humanReadableInt</code> method is
        rewritten on February 5, 2013 to solve an issue of a race condition
        (issue no. <a href="https://issues.apache.org/jira/browse/HADOOP-9252">HADOOP-9252</a>).
        Similar to the first example, the clone code snippet on Stack Overflow does not
        include its original <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache v.2.0 license</a>.
      </p>
      <div class="col-md-6 text-left">
          <!-- HTML generated using hilite.me -->
          <div class="code"><pre style="line-height: 125%"><span style="color: #888888">/* Code in Stack Overflow post ID 801987 (no license) */</span>
<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">static</span> String <span style="color: #0066BB; font-weight: bold">humanReadableInt</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">long</span> number<span style="color: #333333">)</span> <span style="color: #333333">{</span>
    <span style="color: #333399; font-weight: bold">long</span> absNumber <span style="color: #333333">=</span> Math<span style="color: #333333">.</span><span style="color: #0000CC">abs</span><span style="color: #333333">(</span>number<span style="color: #333333">);</span>
    <span style="color: #333399; font-weight: bold">double</span> result <span style="color: #333333">=</span> number<span style="color: #333333">;</span>
    String suffix <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">;</span>
    <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>absNumber <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">1024</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
      <span style="color: #888888">// nothing</span>
    <span style="color: #333333">}</span> <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>absNumber <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">1024</span> <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">1024</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
      result <span style="color: #333333">=</span> number <span style="color: #333333">/</span> <span style="color: #6600EE; font-weight: bold">1024.0</span><span style="color: #333333">;</span>
      suffix <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;k&quot;</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span> <span style="color: #008800; font-weight: bold">else</span> <span style="color: #008800; font-weight: bold">if</span> <span style="color: #333333">(</span>absNumber <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">1024</span> <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">1024</span> <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">1024</span><span style="color: #333333">)</span> <span style="color: #333333">{</span>
      result <span style="color: #333333">=</span> number <span style="color: #333333">/</span> <span style="color: #333333">(</span><span style="color: #6600EE; font-weight: bold">1024.0</span> <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">1024</span><span style="color: #333333">);</span>
      suffix <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;m&quot;</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span> <span style="color: #008800; font-weight: bold">else</span> <span style="color: #333333">{</span>
      result <span style="color: #333333">=</span> number <span style="color: #333333">/</span> <span style="color: #333333">(</span><span style="color: #6600EE; font-weight: bold">1024.0</span> <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">1024</span> <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">1024</span><span style="color: #333333">);</span>
      suffix <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;g&quot;</span><span style="color: #333333">;</span>
    <span style="color: #333333">}</span>
    <span style="color: #008800; font-weight: bold">return</span> oneDecimal<span style="color: #333333">.</span><span style="color: #0000CC">format</span><span style="color: #333333">(</span>result<span style="color: #333333">)</span> <span style="color: #333333">+</span> suffix<span style="color: #333333">;</span>
  <span style="color: #333333">}</span>
            </pre></div>
      </div>

      <div class="col-md-6 text-left">
        <!-- HTML generated using hilite.me -->
        <div class="code">
          <pre style="margin: 0; line-height: 125%"><span style="color: #888888">/* StringUtils.java (2013-02-05) (Apache v.2.0 license) */</span>
<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">static</span> String <span style="color: #0066BB; font-weight: bold">humanReadableInt</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">long</span> number<span style="color: #333333">)</span> <span style="color: #333333">{</span>
  <span style="color: #008800; font-weight: bold">return</span> TraditionalBinaryPrefix<span style="color: #333333">.</span><span style="color: #0000CC">long2String</span><span style="color: #333333">(</span>number<span style="color: #333333">,</span><span style="background-color: #fff0f0">&quot;&quot;</span><span style="color: #333333">,</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">);</span>
<span style="color: #333333">}</span>
          </pre></div>

        </div>
      </div>

    </div>

</div>

        </div>
    </div>

    <footer class="footer">
    <div class="container">

        <p class="text-center">
            Toxic code snippets on Stack Overflow | University College London, UK &amp; University of Molise, Italy (2017) |
            Powered by <a href="https://github.com/aksakalli/jekyll-doc-theme">Jekyll Doc Theme</a>
        </p>
        <!-- <p class="text-muted">Place sticky footer content here.</p> -->
    </div>
</footer>

    <script>
  var baseurl = '/cloverflow-web'
</script>
<script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="/cloverflow-web/js/bootstrap.min.js "></script>
<script src="/cloverflow-web/js/typeahead.bundle.min.js "></script>

<script src="/cloverflow-web/js/main.js "></script>

</body>

</html>
